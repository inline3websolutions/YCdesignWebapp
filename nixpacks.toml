# Nixpacks configuration for Railway
# Disable caching of the .next directory to prevent clientReferenceManifest issues

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["corepack enable", "pnpm install --frozen-lockfile"]

[phases.build]
cmds = ["rm -rf .next || true", "pnpm run build", "cp -r public .next/standalone/public", "cp -r .next/static .next/standalone/.next/static"]

# Disable caching of .next folder
[caches]
skip = [".next"]

[start]
cmd = "node .next/standalone/server.js"
